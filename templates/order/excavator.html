{% extends "base.html" %}

{% block content %}
<div class="page">
    {% include 'components/header.html'%}
    {% include 'components/cart.html'%} 
    <div class="content">
        {% include 'components/username.html' %}
        <h4 class="ms-4">Excavator</h4>
        <div class="breadcrumb d-flex gap-2 ms-4">
            <a href="/"><i data-feather="home"></i></a> 
            <p>/</p>
            <b>Excavator</b>
        </div>
        {% for category, fields in grouped_data.items %}
            <h2>{{ category }}</h2>
            {% for field_data in fields %}
                <h3>{{ field_data.field.lableText }}</h3>
                <ul>
                    {% for option_data in field_data.options %}
                        <li>
                            {{ option_data.option.optionText }} - 
                            EUR: {{ option_data.prices.EUR }},
                            DKK: {{ option_data.prices.DKK }},
                            USD: {{ option_data.prices.USD }},
                            AUD: {{ option_data.prices.AUD }}
                        </li>
                    {% endfor %}
                </ul>
            {% endfor %}
        {% endfor %}
    </div> 
</div>
{% endblock content %}

{% block script %}
<script defer>
    const content = $(".content")
    const cart = $(".cart");
    const btnOrder = $(".btnOrder")
    let cartOut = false;

    function getContentWidth() {
        contentWidth = content.css("width");
        return parseFloat(contentWidth) / 2 + "px"
    };
    
    btnOrder.on("click", toggleCart);
    $(".closeButton").on("click", toggleCart)

    function toggleCart() {
        const contentWidth = getContentWidth();
        if (!cartOut) {
            cart.css("right", 0)
            let padding = contentWidth
            content.css("padding-right", padding)
            btnOrder.html("Hide order")
        }else {
            cart.css("right", "-" + contentWidth)
            content.css("padding-right", "0px")
            btnOrder.html("Show order")
        }
        cartOut = !cartOut 
    }

    $(window).on("resize", function () {
        if (cartOut) {
            content.css("padding-right", getContentWidth());
        } else {
            cart.css("right", "-" + getContentWidth())
        }
    });
</script>
{% endblock script %}